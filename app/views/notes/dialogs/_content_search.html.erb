<!-- Content Search Dialog (Ctrl+Shift+F) -->
<div data-controller="content-search"
     data-action="content-search:selected->app#onSearchResultSelected">
  <dialog
    class="p-0 rounded-lg shadow-xl backdrop:bg-black/50 w-[700px] max-h-[80vh]"
    data-content-search-target="dialog"
  >
    <div class="flex flex-col max-h-[80vh]">
      <!-- Search Input -->
      <div class="p-3 border-b border-[var(--theme-border)]">
        <div class="flex items-center gap-2">
          <svg class="w-5 h-5 text-[var(--theme-text-muted)]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16l2.879-2.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242zM21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <input
            type="text"
            data-content-search-target="input"
            data-action="input->content-search#onInput keydown->content-search#onKeydown"
            class="flex-1 bg-transparent border-0 text-[var(--theme-text-primary)] placeholder-[var(--theme-text-muted)] focus:outline-none text-sm font-mono"
            placeholder="<%= t('dialogs.content_search.placeholder') %>"
            autocomplete="off"
            spellcheck="false"
          >
          <span class="text-xs text-[var(--theme-text-faint)]"><%= t('dialogs.file_finder.esc_to_close') %></span>
        </div>
        <div class="mt-1 text-xs text-[var(--theme-text-muted)]" data-content-search-target="status">
          <%= t('dialogs.content_search.status') %>
        </div>
        <div class="mt-2 text-xs text-[var(--theme-text-faint)] flex flex-wrap gap-x-4 gap-y-1">
          <span><code class="bg-[var(--theme-bg-tertiary)] px-1 rounded">hello</code> <%= t('dialogs.content_search.literal_text') %></span>
          <span><code class="bg-[var(--theme-bg-tertiary)] px-1 rounded">hello|world</code> <%= t('dialogs.content_search.or_operator') %></span>
          <span><code class="bg-[var(--theme-bg-tertiary)] px-1 rounded">hel+o</code> <%= t('dialogs.content_search.one_or_more') %></span>
          <span><code class="bg-[var(--theme-bg-tertiary)] px-1 rounded">hel.*o</code> <%= t('dialogs.content_search.any_chars') %></span>
          <span><code class="bg-[var(--theme-bg-tertiary)] px-1 rounded">^hello</code> <%= t('dialogs.content_search.start_of_line') %></span>
          <span><code class="bg-[var(--theme-bg-tertiary)] px-1 rounded">hello$</code> <%= t('dialogs.content_search.end_of_line') %></span>
          <span><code class="bg-[var(--theme-bg-tertiary)] px-1 rounded">\d+</code> <%= t('dialogs.content_search.digits') %></span>
          <span><code class="bg-[var(--theme-bg-tertiary)] px-1 rounded">\bword\b</code> <%= t('dialogs.content_search.whole_word') %></span>
        </div>
      </div>

      <!-- Results List -->
      <div class="flex-1 overflow-y-auto min-h-[200px] max-h-[60vh] relative">
        <!-- Loading Spinner -->
        <div
          data-content-search-target="spinner"
          class="hidden absolute inset-0 flex items-center justify-center bg-[var(--theme-bg-primary)]/80 z-10"
        >
          <div class="flex flex-col items-center gap-2">
            <svg class="animate-spin h-8 w-8 text-[var(--theme-accent)]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span class="text-sm text-[var(--theme-text-muted)]"><%= t('status.searching') %></span>
          </div>
        </div>
        <!-- Results -->
        <div
          data-content-search-target="results"
          data-action="mousemove->content-search#onMouseMove"
        >
          <!-- Results rendered by JavaScript -->
        </div>
      </div>
    </div>
  </dialog>
</div>
