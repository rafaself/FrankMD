<!-- Emoji Picker Dialog -->
<div data-controller="emoji-picker"
     data-emoji-picker-columns-value="10"
     data-emoji-picker-emoticon-columns-value="5"
     data-action="emoji-picker:selected->app#onEmojiSelected">
  <dialog
    class="p-0 rounded-lg shadow-xl backdrop:bg-black/50 bg-[var(--theme-bg-secondary)] border border-[var(--theme-border)] w-[500px] max-h-[70vh]"
    data-emoji-picker-target="dialog"
    data-app-target="emojiPickerDialog"
  >
    <div class="flex flex-col h-full max-h-[70vh]">
      <!-- Header with tabs and search -->
      <div class="flex-none p-3 border-b border-[var(--theme-border)]">
        <div class="flex items-center justify-between mb-2">
          <div class="flex gap-1">
            <button
              type="button"
              data-emoji-picker-target="tabEmoji"
              data-action="click->emoji-picker#switchToEmoji"
              class="px-3 py-1 text-sm rounded-md bg-[var(--theme-accent)] text-[var(--theme-accent-text)]"
            ><%= t('dialogs.emoji_picker.tab_emoji') %></button>
            <button
              type="button"
              data-emoji-picker-target="tabEmoticons"
              data-action="click->emoji-picker#switchToEmoticons"
              class="px-3 py-1 text-sm rounded-md hover:bg-[var(--theme-bg-hover)] text-[var(--theme-text-muted)]"
            ><%= t('dialogs.emoji_picker.tab_emoticons') %></button>
          </div>
          <button
            type="button"
            data-action="click->emoji-picker#close"
            class="p-1 rounded hover:bg-[var(--theme-bg-hover)] text-[var(--theme-text-muted)]"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        <input
          type="text"
          data-emoji-picker-target="input"
          data-action="input->emoji-picker#onInput keydown->emoji-picker#onKeydown"
          class="w-full px-3 py-2 text-sm border border-[var(--theme-border)] rounded-md bg-[var(--theme-bg-primary)] text-[var(--theme-text-primary)] placeholder-[var(--theme-text-muted)] focus:outline-none focus:ring-2 focus:ring-[var(--theme-accent)]"
          placeholder="<%= t('dialogs.emoji_picker.search_placeholder') %>"
          autocomplete="off"
          spellcheck="false"
        >
      </div>

      <!-- Grid -->
      <div class="flex-1 overflow-y-auto p-3 min-h-0">
        <div
          data-emoji-picker-target="grid"
          class="grid gap-1"
          style="grid-template-columns: repeat(10, minmax(0, 1fr));"
        >
          <!-- Items rendered by JavaScript -->
        </div>
      </div>

      <!-- Preview footer -->
      <div class="flex-none p-3 border-t border-[var(--theme-border)] bg-[var(--theme-bg-tertiary)]">
        <div
          data-emoji-picker-target="preview"
          class="flex items-center justify-center gap-3 h-12 text-[var(--theme-text-primary)]"
        >
          <!-- Preview rendered by JavaScript -->
        </div>
      </div>
    </div>
  </dialog>
</div>
